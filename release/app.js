var __t;__t=function(ns){var curr,index,part,parts,_i,_len;curr=null,parts=[].concat=ns.split(".");for(index=_i=0,_len=parts.length;_i<_len;index=++_i){part=parts[index];if(curr===null){curr=eval(part);continue}curr[part]==null?curr=curr[part]={}:curr=curr[part]}return curr};var Build,CitrusApp,CitrusUseCase,InMemoryStorage,InMemoryStreamingSource,Organization,Project,WebGlue,WebGui,__bind=function(a,b){return function(){return a.apply(b,arguments)}};_.defaults(this,{Before:function(a,b,c){return YouAreDaBomb(a,b).before(c)},BeforeAnyCallback:function(a,b,c){return YouAreDaBomb(a,b).beforeAnyCallback(c)},After:function(a,b,c){return YouAreDaBomb(a,b).after(c)},Around:function(a,b,c){return YouAreDaBomb(a,b).around(c)}}),CitrusUseCase=function(){function a(){this.selectBuild=__bind(this.selectBuild,this),this.selectProject=__bind(this.selectProject,this),this.start=__bind(this.start,this),this.setOrganization=__bind(this.setOrganization,this),this.organization=null,this.currentProject=null,this.currentBuild=null}return a.prototype.setOrganization=function(a){this.organization=a},a.prototype.start=function(){return this.selectProject(this.organization.projects[0]),this.selectBuild(this.currentProject.builds[0])},a.prototype.selectProject=function(a){return console.log("selecting project: "+a.name),this.currentProject=a},a.prototype.selectBuild=function(a){return console.log("selecting build: "+a.id),this.currentBuild=a},a}(),Organization=function(){function a(a){this.name=a,this.addProject=__bind(this.addProject,this),this.projects=[]}return a.prototype.addProject=function(a){var b;return b=new Project(a),this.projects.push(b),b},a}(),Project=function(){function a(a){this.name=a,this.addBuild=__bind(this.addBuild,this),this.builds=[]}return a.prototype.addBuild=function(a,b){return this.builds.push(new Build(a,b))},a}(),Build=function(){function a(a,b){this.id=a,this.changeName=b}return a}(),WebGui=function(){function a(){this.appendToBuildConsoleLogs=__bind(this.appendToBuildConsoleLogs,this),this.showBuild=__bind(this.showBuild,this),this.showProject=__bind(this.showProject,this),this.hideProject=__bind(this.hideProject,this),this.hideOrganization=__bind(this.hideOrganization,this),this.showOrganization=__bind(this.showOrganization,this)}return a.prototype.showOrganization=function(a){var b,c,d,e;return d=$("#organization-view-template").html(),e=Handlebars.compile(d),b={name:a.name,projects:a.projects.map(function(a){return{name:a.name}})},c=e(b),$("#organization-view").html(c),$("#organization-view").show()},a.prototype.hideOrganization=function(){return $("#organization-view").hide()},a.prototype.hideProject=function(){return $("#project-view").hide()},a.prototype.showProject=function(a){var b,c,d,e;return d=$("#project-view-template").html(),e=Handlebars.compile(d),b={name:a.name,builds:a.builds.map(function(a){return{id:a.id}})},c=e(b),$("#project-view").html(c),$("#project-view").show()},a.prototype.showBuild=function(a){var b,c,d,e;return d=$("#build-view-template").html(),e=Handlebars.compile(d),b={id:a.id,changeName:a.changeName},c=e(b),$("#build-view").html(c),$("#build-view").show()},a.prototype.appendToBuildConsoleLogs=function(a){return $("#console-logs").append(a)},a}(),WebGlue=function(){function a(a,b,c,d){this.useCase=a,this.gui=b,this.storage=c,this.streamingSource=d,this.appendDataToBuildConsoleLogs=__bind(this.appendDataToBuildConsoleLogs,this),this.showBuild=__bind(this.showBuild,this),this.showProject=__bind(this.showProject,this),this.showOrganization=__bind(this.showOrganization,this),this.loadData=__bind(this.loadData,this),Before(this.useCase,"start",this.loadData),After(this.useCase,"setOrganization",this.showOrganization),After(this.useCase,"selectProject",this.showProject),After(this.useCase,"selectBuild",this.showBuild),After(this.streamingSource,"newData",this.appendDataToBuildConsoleLogs)}return a.prototype.loadData=function(){return this.useCase.setOrganization(this.storage.loadData())},a.prototype.showOrganization=function(a){return this.gui.showOrganization(a)},a.prototype.showProject=function(a){return this.gui.hideOrganization(),this.gui.showProject(a)},a.prototype.showBuild=function(a){return this.gui.hideProject(),this.gui.showBuild(a)},a.prototype.appendDataToBuildConsoleLogs=function(a){return this.gui.appendToBuildConsoleLogs(a)},a}(),InMemoryStorage=function(){function a(){this.loadData=__bind(this.loadData,this)}return a.prototype.loadData=function(){var a,b;return b=new Organization("DRUG"),a=b.addProject("Citrus"),a.addBuild("Build 13","[Shared] Game has awarded prizes via players not via prizes. Prizes can be deleted and game still has awarded prizes"),b},a}(),InMemoryStreamingSource=function(){function a(){this.newData=__bind(this.newData,this),this.startStreaming=__bind(this.startStreaming,this)}return a.prototype.startStreaming=function(){var a,b=this;return console.log("started streaming"),a=setInterval(function(){return b.newData(""+(new Date).toLocaleTimeString()+"\n")},1e3),setTimeout(function(){return clearInterval(a)},2e4)},a.prototype.newData=function(a){return console.log("new data received: "+a)},a}(),CitrusApp=function(){function a(){var a,b,c,d,e;e=new CitrusUseCase,b=new WebGui,c=new InMemoryStorage,d=new InMemoryStreamingSource,d.startStreaming(),a=new WebGlue(e,b,c,d),e.start()}return a}(),new CitrusApp